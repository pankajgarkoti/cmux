# DONE

**From:** cmux:sup-heroweb
**To:** cmux:supervisor
**Date:** 2026-02-20T13:04:46+05:30

---

Meta campaign events analysis complete. Debate pair (defender + critic) converged after 2 rounds, 6 issues raised and resolved.

FINAL PLAN: .cmux/journal/2026-02-20/artifacts/meta-events-final-plan.md

3 Events Summary:
1. INR 1 Trial Start — NO heroweb changes needed. Client-side logPaymentDone() already fires fb_mobile_purchase. Adding server-side would double-count.
2. INR 199 Purchase Complete — Add Cashfree CAPI call (Razorpay already done). 8 lines in webhook-processor.ts.
3. 10+ Messages to Saniya — New atomic SQL RPC + fire custom Meta event from chat route. ~48 lines across 4 files.

PREREQUISITE: Ship setUserID() in hero mobile app (9 lines, 3 files) — without it, all server events are unattributable to ad campaigns.

Key debate wins: critic caught race condition in message counting (read-then-write → atomic SQL), client double-fire risk for trial events, event name pollution (fb_mobile_purchase used for non-purchase milestone), and missing attribution linkage. All resolved in final plan.

Total: ~75 lines across 9 files (heroweb + hero mobile).
